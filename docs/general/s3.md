# Configuring Object Storage for AWS S3 Apps

The Jetstream2 object store hosts an S3-compatible API at the endpoint `https://js2.jetstream-cloud.org:8001`. This document will cover how to generate credentials and configure a storage bucket for use with S3-style apps. 

There is also a supplemental tutorial from Andrea Zonca on [Using the distributed file format Zarr on Jetstream 2 object storage](https://zonca.dev/2022/04/zarr-jetstream2.html){target=_blank}, which leverages [S3FS](https://pypi.org/project/s3fs/){target=_blank}.

---

## Prerequisites

### EC2 Credentials
If the you want to use S3 compatibility, youâ€™ll need to generate EC2 credentials via the OpenStack CLI.

```
openstack ec2 credentials create
```

If you do not have CLI clients installed and an application credential openrc, please see [*Installing Openstack Clients*](../ui/cli/clients.md){target=_blank} and [*Authenticating Against the OpenStack CLI (Logging In)*](../ui/cli/auth.md){target=_blank}.
{: .note }

Make note of the `access` and `secret` fields--these will be needed for authentication. If forgotten, they can be retrieved again in the future with

```
openstack ec2 credentials list
```

### AWS CLI
Unfortunately, configuring S3-style settings for buckets is not currently possible through graphical interfaces like [Horizon](../ui/horizon/intro.md){target=_blank}. As such, an API wrapper like the <abbr title="Amazon Web Services Command-Line Interface">AWS CLI</abbr> is needed.

After [installing the AWS CLI](https://aws.amazon.com/cli/){target=_blank}, create a new credentials file to house your EC2 credentials created above:

```
mkdir -p ~/.aws
touch ~/.aws/credentials
```

Edit the file to include the following lines, where the values for `aws_access_key_id` and `aws_secret_access_key` correspond to the aforementioned OpenStack fields `access` and `secret`, respectively:

```
[default]
region=RegionOne
aws_access_key_id=your_access_here
aws_secret_access_key=your_secret_here
```

Test the authentication by querying:

```
aws s3api --endpoint 'https://js2.jetstream-cloud.org:8001' list-buckets
```

Note that calls to `aws s3api` require specifying the Jetstream2 endpoint with the `--endpoint` flag, as shown above. One workaround to including this with every command is to set an `alias s3api="aws s3api --endpoint 'https://js2.jetstream-cloud.org:8001'"`.
{: .note}

---

## Bucket Configuration

### Access Control List (ACL)

Under Amazon S3, every bucket and object has an [access ](){} attached that defines both who can access that resource and the level of access they are granted. The default ACL 

### (Optional) Configure CORS